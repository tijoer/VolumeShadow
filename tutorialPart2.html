<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Volume Shadow</title>
	<link rel="stylesheet" type="text/css" href="style.css"/>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="content-language" content="en"/>
	<meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache"/>
	<meta http-equiv="expires" content="0">
    <meta name="author" content="Tim Jörgen"/>
    <meta name="publisher" content="Tim Jörgen"/>
    <meta name="description" content="This is an Java Opengl lib to create volumetric shadows. You can add shadows to your scenes in a few minutes, with this library. "/>
    <meta name="keywords" content="OpenGl, JOGL, Shadow, Volume, Volumetric, Shadow, Volumetric, Shadow, Java, Library, lib"/>
    <meta name="page-topic" content="Forschung Technik"/>
    <meta name="audience" content="Profis"/>
    <meta name="robots" content="index, follow"/>
    <meta name="revisit-after" content="1 days"/>
	
	<!-- JQuery is needed by several Javascript plugins -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7/jquery-ui.min.js"></script>

	<!-- This is the JQuery container plugin -->
	<link rel="stylesheet" type="text/css" href="js/jquery.mb.containerPlus.2.5.1/css/mbContainer.css" title="style"  media="screen"/>
	<script type="text/javascript" src="js/jquery.mb.containerPlus.2.5.1/inc/mbContainer.js"></script>
	<script type="text/javascript" src="js/jquery.mb.containerPlus.2.5.1/inc/jquery.metadata.js"></script>
	<script type="text/javascript">
	$(function(){
	  $(".containerPlus").buildContainers({
		containment:"document",
		elementsPath:"js/jquery.mb.containerPlus.2.5.1/elements/",
		mantainOnWindow:false
	  });
	});
	</script>
	<!-- End of container plugin -->
	
	<!-- JQuery fancybox plugin -->
	<script type="text/javascript" src="js/jquery.fancybox-1.3.1/fancybox/jquery.mousewheel-3.0.2.pack.js"></script> 
	<script type="text/javascript" src="js/jquery.fancybox-1.3.1/fancybox/jquery.fancybox-1.3.1.js"></script> 
	<link rel="stylesheet" type="text/css" href="js/jquery.fancybox-1.3.1/fancybox/jquery.fancybox-1.3.1.css" media="screen" /> 
 	<link rel="stylesheet" href="style.css" /> 
	<script type="text/javascript"> 
		$(document).ready(function() {
			/*
			*   Examples - images
			*/
 
			$("a#screenshot1").fancybox({
				'titleShow'		: true,
				'transitionIn'	: 'elastic',
				'transitionOut'	: 'elastic',
				'titlePosition'	: 'inside',
				'width'				: '75%',
				'height'			: '75%',
				'autoScale'			: true
			});
		});
	</script> 
	<!-- End of fancybox plugin -->
</head>

<body>
<a href="http://github.com/iuiz/VolumeShadow"><img style="position: absolute; top: 0; right: 0; border: 0;height:100px;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
<div id="topLine">
		<div id="header">
		
			<ul class="nav">
			<li><a href="index.html">Home</a></li>
			<li class="active"><a href="tutorial.html">Tutorial</a></li>
			<li><a href="contact.html">Contact</a></li>
			<li><a href="http://github.com/iuiz/VolumeShadow">Github</a></li>
			</ul>
			
			<h1><span class="greenHeader">||</span>Volume<span class="greenHeader">Shadow</span></h1>
			
		</div>
</div>

<div id="outerwarrper">
	<div id="wrapper">
		<div class="sidebar">
			<h3>Index</h3>
			<a href="tutorial.html" class="inverted">Part 1</a>
			<ul class="side">
				<li><a href="tutorial.html">Introduction</a></li>
				<li><a href="tutorial.html#notCover">What will this tutorial not cover</a></li>
				<li><a href="tutorial.html#obtaining">Obtaining the library</a></li>
				<li><a href="tutorial.html#setup">Setup your workspace</a></li>
			</ul>
			<a href="tutorialPart2.html" class="inverted">Part 2</a>
			<ul class="side">
				<li><a href="tutorialPart2.html">A basic scene</a></li>
				<li><a href="tutorialPart2.html#addingAnOccluder">Adding an occluder</a></li>
				<li><a href="tutorialPart2.html#addingALight">Adding a light</a></li>
			</ul>
			<a href="tutorialPart2.html" class="inverted">Part 3</a>
			<ul class="side">
				<li><a href="tutorialPart3.html">Using the library</a></li>
			</ul>
		</div>
		
		<h2 class="firstHeading">Tutorial - part 2</h2>
		<p>This part will now show you how to implement the VolumeShadow interface and draw a basic scene. Most of the code is OpenGl geometrie, so don't get a shock as this page is quite long.</p>
		
		<h3 class="firstHeading"><a name="aBasicScene"></a>A basic scene</h3>
		<p>Lets create a scene that acually uses a first part of the lib. Create a new class called <code>World</code> in a separate file. This class will contain our world (as the name implies) with a room, a light and a 3D object that casts shadow on the walls. The class needs to implement <code>org.volumeshadow.ShadowScene</code> and a needs to have a reference to the GL context. The context can be passed in the constructor and stored in a local field. Remember to add all the includes, that are needed by the interface and for the <code>GL</code> class.</p>
		
		<div id="tutPart2listing1" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:35px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 1 - <span>Tipp: You can resize the listings on the bottom border.</span></div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
package shadowTutorial;

import java.util.ArrayList;
import javax.media.opengl.GL;
import org.volumeshadow.math.Triangle;
import org.volumeshadow.math.Vector3f;

public class World implements org.volumeshadow.ShadowScene {
	
	private GL gl;

	public World(GL gl) {
		this.gl = gl;
	}

	@Override
	public ArrayList<Triangle> getOccluderVertexData() {
		return null;
	}

	@Override
	public Vector3f getOccluderPosition() {
		return null;
	}

	@Override
	public Vector3f getLightPosition() {
		return null;
	}

	@Override
	public void renderWorld(boolean renderWithLight) {
	}

	@Override
	public void renderOccluder(boolean renderWithLight) {
	}
}
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 


		<p>Now we will draw a room in the <code>renderWorld</code> method. Add the folowing code to the method:</p>
<div id="tutPart2listing1" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:30px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 2</div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
gl.glPushMatrix();				
gl.glBegin(GL.GL_QUADS);
gl.glColor3f(1.0f, 0.0f, 0.0f);
gl.glVertex3f(-1.0f, -1.0f, -8.0f);
gl.glVertex3f(1.0f, -1.0f, -8.0f);
gl.glVertex3f(1.0f, 1.0f, -8.0f);
gl.glVertex3f(-1.0f, 1.0f, -8.0f);

gl.glColor3f(0.0f, 1.0f, 0.0f);
gl.glVertex3f(-1.0f, -1.0f, -8.0f);
gl.glVertex3f(-1.0f, -1.0f, -6.0f);
gl.glVertex3f(1.0f, -1.0f, -6.0f);
gl.glVertex3f(1.0f, -1.0f, -8.0f);

gl.glColor3f(0.0f, 0.0f, 1.0f);
gl.glVertex3f(1.0f, -1.0f, -8.0f);
gl.glVertex3f(1.0f, -1.0f, -6.0f);
gl.glVertex3f(1.0f, 1.0f, -6.0f);
gl.glVertex3f(1.0f, 1.0f, -8.0f);
gl.glEnd();
gl.glPopMatrix();
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 

		<p>This is not the prettiest room we have ever seen, as it has only 2 walls (and the ground), but it will be enough for our purpose.
		
		<h3 class="heading"><a name="addingAnOccluder"></a>Adding an occluder</h3>
		<p>Let's add an occluder. To give the VolumeShadow lib the capability to calculate a shadow volume, we need to provide it with the vertex data. So we will not only draw a occluder, but also draw it from a data structure that holds the triangle data. So lets apply the following changes.</p>
<div id="tutPart2listing1" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:30px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 3</div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
private Triangle tri;
private ArrayList<Triangle> occluder;

public World(GL gl) {
	this.gl = gl;
	tri = new Triangle(new Vector3f(-0.3f, -0.3f, -7.0f),
				new Vector3f(0.1f, -0.4f, -6.0f), 
				new Vector3f(0.2f, 0.4f, -7.0f));
	occluder = new ArrayList<Triangle>();
	occluder.add(tri);
}

@Override
public ArrayList<Triangle> getOccluderVertexData() {
	return this.occluder;
}

@Override
public Vector3f getOccluderPosition() {
	return new Vector3f(0.0f, 0.0f, 0.0f);
}


public void renderOccluder(boolean renderWithLight) {
	gl.glColor3f(1.0f, 1.0f, 0.0f);
	gl.glBegin(GL.GL_TRIANGLES);
	for (Iterator<Triangle> iterator = this.occluder.iterator(); iterator.hasNext();) {
		Triangle tri = (Triangle) iterator.next();
		gl.glVertex3f(tri.get(0).x, tri.get(0).y, tri.get(0).z);
		gl.glVertex3f(tri.get(1).x, tri.get(1).y, tri.get(1).z);
		gl.glVertex3f(tri.get(2).x, tri.get(2).y, tri.get(2).z);
	}
	gl.glEnd();
}
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 
		<p>Notice how we return a vector with <code>0.0f, 0.0f, 0.0f</code> in <code>getOccluderPosition</code>, as we don't do any tanslations in the <code>renderOccluder</code> method.</p>

		<p>Now back to the Main class. Apply the following changes so that our scene is drawn and have a first look at our scene.</p>
		<div id="tutPart2listing2" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:25px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 4</div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
World world;

public void init(GLAutoDrawable gLAutoDrawable) {
	...
	world = new World(gl);
}

public void display(GLAutoDrawable arg0) {
	gl.glClear(GL.GL_COLOR_BUFFER_BIT | GL.GL_DEPTH_BUFFER_BIT);
	gl.glLoadIdentity();
	
	gl.glRotatef(20.0f, 1.0f, 0.0f, 0.0f);
	gl.glRotatef(40.0f, 0.0f, 1.0f, 0.0f);
	gl.glTranslatef(5.0f, -3.0f, 0.0f);
	
	world.renderWorld(1.0f);
	world.renderOccluder(1.0f);
}
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 
		<p>Now here is our simple scene for now. We have a gound, two walls and a triangle in the middle, which will be our occluder.<center><a id="screenshot1" href="images/tutorial/basicScene.png"><img src="images/tutorial/basicScene.png" width="150" alt="A first look at our scene." style="float:middle;"/> </a></center>

		<h3 class="heading"><a name="addingALight"></a>Adding a light</h3>
		<p>Now we still need to add a ligth to our scene. However we won't use the OpenGl lighting functionality, our a shader, but just draw a sphere on the position where the light should be. You can use OpenGl lighting if you want, but in this tutorial we won't. The shadow will be created, because the scene is drawn two times. One time bright and one time dark. You can archive this, by toggling <code>GL.GL_LIGHTING</code>, but you can also achieve this with changing the colors. As this is a basic example scene without normals, we will just change the colors. But we will draw a sphere on the position of our shadow casting light, to better visualize what is happening.</p>


		<div id="tutPart2listing1" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:30px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 5</div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
import com.sun.opengl.util.GLUT;
....
private GLUT glut = new GLUT();
private Vector3f lightPosition = new Vector3f(1.0f, 1.0f, -4.0f);

@Override
public Vector3f getLightPosition() {
	return this.lightPosition;
}

@Override
public void renderWorld(boolean renderWithLight) {
	gl.glPushMatrix();
	gl.glTranslatef(lightPosition.x, lightPosition.y, lightPosition.z);
	gl.glColor3f(1.0f, 0.3f, 0.5f);
	glut.glutSolidSphere(0.1f, 20, 20);
	gl.glPopMatrix();
	... //the rest from render World, that we already coded
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 
		
		<p>At last we add the ability to draw the scene either with or without light. Depending on <code>boolean renderWithLight</code>. We add a float to the <code>renderWorld</code> method and multiply all the color values with it. If the boolean is false, the float will be 0.3f, if the boolean is true the float is 1.0f. The final <code>renderWorld</code>method looks like this:</p>
		<div id="tutPart2listing1" class="containerPlus resizable {buttons:'m', icon:'../../../../images/javaIcon.gif', skin:'white', height:'200', width:'650',closed:'false', rememberMe:'false', minHeight:'100'}" style="margin:30px 0px 0px 25px;"> 
			<div class="no"><div class="ne"><div class="n">Listing 6</div></div> 
				<div class="o"><div class="e"><div class="c"> 
				<div class="mbcontainercontent"> 
<pre style="font-size:10px;">
	public void renderWorld(boolean renderWithLight) {
		float lightFactor = 1.0f;
		if(!renderWithLight) {
			lightFactor = 0.3f;
		}
		
		gl.glPushMatrix();
		gl.glTranslatef(lightPosition.x, lightPosition.y, lightPosition.z);
		gl.glColor3f(1.0f, 0.3f, 0.5f);
		glut.glutSolidSphere(0.1f, 20, 20);
		gl.glPopMatrix();
		
		gl.glPushMatrix();				
		gl.glBegin(GL.GL_QUADS);
		gl.glColor3f(1.0f*lightFactor, 0.0f, 0.0f);
		gl.glVertex3f(-1.0f, -1.0f, -8.0f);
		gl.glVertex3f(1.0f, -1.0f, -8.0f);
		gl.glVertex3f(1.0f, 1.0f, -8.0f);
		gl.glVertex3f(-1.0f, 1.0f, -8.0f);
		
		gl.glColor3f(0.0f, 1.0f*lightFactor, 0.0f);
		gl.glVertex3f(-1.0f, -1.0f, -8.0f);
		gl.glVertex3f(-1.0f, -1.0f, -6.0f);
		gl.glVertex3f(1.0f, -1.0f, -6.0f);
		gl.glVertex3f(1.0f, -1.0f, -8.0f);
		
		gl.glColor3f(0.0f, 0.0f, 1.0f*lightFactor);
		gl.glVertex3f(1.0f, -1.0f, -8.0f);
		gl.glVertex3f(1.0f, -1.0f, -6.0f);
		gl.glVertex3f(1.0f, 1.0f, -6.0f);
		gl.glVertex3f(1.0f, 1.0f, -8.0f);
		gl.glEnd();
		gl.glPopMatrix();
	}
	
</pre>
				</div> 
				</div></div></div> 
				<div > 
				<div class="so"><div class="se"><div class="s"> </div></div></div> 
				</div> 
			</div> 
		</div> 

<p>This is our scene now. One time rendered with <code>true</code> and one time with <code>false</code>.<center><a id="screenshot1" href="images/tutorial/brightAndDark.png"><img src="images/tutorial/brightAndDark.png" width="150" alt="Our scene with both light settings." style="float:middle;"/> </a></center>
<p>The next part will finaly display the shadow. <a href="tutorialPart3.html">Continue to part 3...</a></p>

	</div>
</div>


<div id="footer">
	<p>Design By:<a href="http://www.templatesforfree.net"><del>TemplatesForFree.net</del></a> (Link not working anymore.)</p>
	<!--<p><a href="http://validator.w3.org/check?uri=referer" onmouseover="doTooltip(event,0)" onmouseout="hideTip()"><img class="xhtmlButton" src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Transitional"/></a></p>-->
</div>

<div id="tipDiv" style="position:absolute; visibility:hidden; z-index:100"></div>

</body>
</html>
